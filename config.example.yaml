# GitMusic 配置文件示例
# 复制此文件为 config.yaml 并修改以下设置

# =============================================================================
# 传输配置 (Transport)
# =============================================================================
transport:
  # SSH连接配置
  user: your_username               # SSH用户名
  host: your.server.com             # 远程服务器地址
  remote_data_root: /srv/music/data # 远程数据根目录
  
  # 传输设置
  retries: 5                        # 失败重试次数（指数退避策略）
  timeout: 60                       # 单文件超时时间（秒）
  workers: 4                        # 并行传输线程数

# =============================================================================
# 路径配置 (Paths)
# =============================================================================
paths:
  # 本地路径配置（使用绝对路径）
  work_dir: /path/to/your/work/dir           # 工作目录，存放待发布的MP3文件
  cache_root: /path/to/your/cache            # 缓存根目录，存储音频和封面对象
  metadata_file: /path/to/your/metadata.jsonl  # 元数据数据库文件
  release_dir: /path/to/your/release         # 发布目录，生成最终音乐库
  logs_dir: /path/to/your/logs               # 日志目录，存储JSONL事件日志

# =============================================================================
# 图像处理配置 (Image Processing)
# =============================================================================
image:
  # 封面图片处理设置
  quality: 2                        # 封面压缩质量 (1-100)，数字越大质量越好体积越大
  
  # 压缩阈值（可选）
  # compress_threshold: "100kb"    # 仅压缩大于此大小的封面，支持单位: b, kb, mb, gb

# =============================================================================
# 命令默认行为配置 (Command Defaults)
# =============================================================================
command_defaults:
  # publish命令
  publish:
    on_error: "stop"                # 错误处理策略: stop, continue, notify
  
  # checkout命令
  checkout:
    on_error: "stop"
    limit: 100                      # 默认限制数量
  
  # release命令
  release:
    on_error: "continue"            # release默认继续执行
    workers: 1                      # 默认并行数
  
  # sync命令
  sync:
    on_error: "continue"
    direction: "both"               # 默认双向同步
  
  # verify命令
  verify:
    on_error: "notify"              # verify默认仅通知
  
  # cleanup命令
  cleanup:
    on_error: "notify"

# =============================================================================
# 高级设置（可选）
# =============================================================================

# FFmpeg配置
# ffmpeg:
#   audio_params:                   # 音频提取参数（默认MP3格式）
#     - "-map"
#     - "0:a:0"
#     - "-c"
#     - "copy"
#     - "-f"
#     - "mp3"
#     - "-map_metadata"
#     - "-1"
#     - "-id3v2_version"
#     - "0"
#     - "-write_id3v1"
#     - "0"
#   
#   cover_params:                   # 封面提取参数
#     - "-vf"
#     - "scale=600:600:force_original_aspect_ratio=decrease"
#     - "-q:v"
#     - "2"

# 哈希配置
# hash:
#   algorithm: "sha256"             # 哈希算法（默认sha256）
#   chunk_size: 8192                # 读取块大小（字节）

# 锁配置
# locking:
#   timeout: 30                     # 锁等待超时时间（秒）
#   lock_dir: ".locks"              # 锁文件目录（相对于项目根）

# =============================================================================
# 日志配置 (Logging)
# =============================================================================
# logging:
#   level: "info"                   # 日志级别: debug, info, warn, error
#   # 注意: 事件日志会自动存储到logs_dir，此处配置的是应用日志

# =============================================================================
# 系统配置 (System)
# =============================================================================
# system:
#   tmp_dir: "/tmp/gitmusic"        # 临时目录（默认使用系统临时目录）
#   max_concurrent_tasks: 10        # 最大并发任务数
#   enable_color: true              # 启用彩色输出

# =============================================================================
# 使用说明
# =============================================================================
# 1. 路径配置:
#    - 所有路径请使用绝对路径
#    - Windows用户: 使用正斜杠 / 或双反斜杠 \
#    - 示例: "C:/Users/username/music" 或 "C:\\Users\\username\\music"
#
# 2. 权限要求:
#    - 确保对所有配置的目录有读写权限
#    - metadata.jsonl文件需要可写权限
#    - 日志目录需要定期清理以避免磁盘占满
#
# 3. SSH配置:
#    - 建议使用SSH密钥认证，避免密码输入
#    - 首次连接前请手动测试SSH连通性
#    - 确保remote_data_root在远程服务器上存在且可写
#
# 4. 性能调优:
#    - workers: 根据网络带宽和服务器性能调整
#    - timeout: 大文件传输时需要适当增加
#    - retries: 网络不稳定时可增加重试次数
#
# 5. 故障排查:
#    - 检查logs_dir中的JSONL日志文件
#    - 使用--log-only模式获取结构化输出
#    - 查看doc/command-spec.md获取详细命令说明